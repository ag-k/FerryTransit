# CLAUDE.md

このファイルは、このリポジトリでコードを扱う際の Claude Code (claude.ai/code)への指針を提供します。

## プロジェクト概要

FerryTransit は、島根県隠岐諸島のフェリー時刻表と航路情報システムです。このアプリケーションは各港間のフェリースケジュールを表示し、日本語と英語の両方をサポートしています。

## 会話ガイドライン

- 常に日本語で会話する
- コード修正後は必ずビルドが通ることを確認する（`npm run build`）
- 関連するユニットテストも実行して動作を確認する（`npm run test:unit`）
- 変更によりユニットテストの修正が必要な場合は、テストも併せて修正する
- 該当機能にユニットテストが存在しない場合は、新規にユニットテストを実装する
- 進捗は CLAUDE.md に記載すること

**現在、AngularJS 版から Nuxt3 版への移行作業が進行中です。**

## プロジェクト構成

```
FerryTransit/
├── archive/                   # AngularJS版（レガシー）
│   ├── index.html            # AngularJS版のメインファイル
│   ├── js/                   # AngularJS版のソースコード
│   ├── css/                  # AngularJS版のスタイル
│   ├── images/               # AngularJS版の画像
│   └── timetable.php         # APIエンドポイント
├── ferry-transit-nuxt/        # Nuxt3版（メイン開発）
├── MIGRATION_PLAN.md          # 移行計画書
└── PHASE1_TASKS.md           # フェーズ1タスクリスト
```

- Nuxt3 版の開発を行う
- AngularJS 版はアーカイブとして保存、参照のみ

## 技術スタック

### AngularJS 版（アーカイブ）

- **フロントエンド**: AngularJS 1.7.9 (レガシーバージョン)
- **言語**: TypeScript (ES5 にコンパイル)
- **UI**: Bootstrap 3.4.1 with Angular UI Bootstrap
- **データストレージ**: SQLite データベースから JSON にエクスポート
- **サーバー**: CORS ヘッダー付きで JSON を提供する PHP

### Nuxt3 版（開発中）

- **フレームワーク**: Nuxt 3.17.5 + Vue 3
- **言語**: TypeScript (strict mode)
- **UI**: Tailwind CSS v4.1.10
- **状態管理**: Pinia
- **国際化**: @nuxtjs/i18n
- **スタイル**: Sass/SCSS + Tailwind CSS
- **ターゲット**: Web + iOS/Android (Capacitor 予定)

## 開発コマンド

### AngularJS 版（アーカイブ）

AngularJS版のファイルは`archive/`ディレクトリに移動されました。参照のみとしてください。

元の構成：
- TypeScript ファイル: `archive/js/controller.ts`, `archive/js/timepicker-ctrl.ts`
- データベース関連: `archive/timetable.sqlite`, `archive/update_timetable.sh`
- PHP API: `archive/timetable.php`

### Nuxt3 版

```bash
cd ferry-transit-nuxt

# 開発サーバー起動
npm run dev

# ビルド
npm run build

# プレビュー
npm run preview

# 型チェック
npm run typecheck

# ユニットテスト
npm run test:unit

# リント
npm run lint
```

## アーキテクチャ概要

### データフロー

1. **ソースデータ**: `timetable.sqlite`に保存されたフェリースケジュール情報
2. **データエクスポート**: `update_timetable.sh`経由で SQLite → JSON
3. **API**: `timetable.php`が CORS ヘッダー付きで JSON を提供
4. **フロントエンド**: AngularJS コントローラーがデータを取得して表示

### コアコンポーネント

#### AngularJS 版

**メインコントローラー (`js/controller.ts`)**

- フェリースケジュール表示を管理
- 言語切り替え（ja/en）を処理
- 日付ベースのフィルタリングを実装
- 港/船情報のモーダルダイアログを制御

#### Nuxt3 版

**ストア構成**

- `ferry.ts`: フェリーと港の情報管理
- `timetable.ts`: 時刻表データの管理
- `ui.ts`: UI 状態（言語、テーマ等）の管理

**主要コンポーネント**

- `DatePicker.vue`: 日付選択コンポーネント
- `PortSelector.vue`: 港選択コンポーネント
- `ShipModal.vue`: 船舶情報モーダル
- `AlertComponent.vue`: 運航アラート表示

**データ構造**
時刻表データには以下が含まれます：

- 港の接続（西郷、菱浦、別府、来居、本土七類、本土境港）
- フェリーサービス（フェリーおき、フェリーしらしま、フェリーくにが、フェリーどうぜん）
- 日時付きスケジュール情報
- サービスアラートと例外

### 主要機能の実装

#### AngularJS 版

- **多言語対応**: Angular Translate を使用
- **日付フィルタリング**: カスタム日付ピッカー実装
- **地図統合**: Google Maps API で港の場所を表示
- **レスポンシブデザイン**: Bootstrap 3 ベースのレイアウト

#### Nuxt3 版

- **多言語対応**: @nuxtjs/i18n を使用（日本語・英語対応）
- **日付フィルタリング**: Vue コンポーネントによる日付ピッカー
- **地図統合**: Google Maps API 統合（実装済み）
- **レスポンシブデザイン**: Tailwind CSS によるモバイルファースト設計

## 重要な考慮事項

### 共通

1. **手動データ更新**: スケジュール更新には手動の SQL 編集とスクリプト実行が必要
2. **CORS 設定**: PHP エンドポイントにはクロスオリジンリクエスト用の CORS ヘッダーが含まれる
3. **日付処理**: 日本のカレンダーの考慮事項とタイムゾーン処理が重要

### AngularJS 版

1. **レガシーフレームワーク**: アクティブにメンテナンスされていない AngularJS 1.x を使用
2. **ブラウザ互換性**: 古いブラウザもサポート

### Nuxt3 版

1. **移行作業中**: AngularJS 版と並行して開発中
2. **モダンブラウザ対象**: ES2015+をサポートするブラウザが必要
3. **SSR/SSG 対応**: サーバーサイドレンダリングに対応
4. **UI フレームワーク**: Tailwind CSS を採用（Bootstrap は不使用）
5. **テスト駆動開発**: Vitest によるユニットテストを実装

## 移行状況

### 完了済み

#### フェーズ 1（基盤構築）

- ✅ プロジェクト基盤の構築
- ✅ 依存関係のセットアップ
- ✅ 型定義の作成
- ✅ 国際化対応
- ✅ 基本レイアウトとルーティング

#### フェーズ 2（データ層）

- ✅ Pinia ストアの実装
- ✅ API エンドポイントの実装
- ✅ データ取得ロジックの移植

#### フェーズ 3（UI/UX）

- ✅ 主要ページの実装（ホーム、時刻表、乗換案内、運航状況）
- ✅ 共通コンポーネントの実装
- ✅ Tailwind CSS の導入と実装
- ✅ レスポンシブデザインの改善

### 次のステップ（フェーズ 4 - ビジネスロジックの詳細実装）

#### 4.1 料金表示システム（2-3日）
- 料金マスターデータの作成
- 料金表示ロジックの実装
- 料金表ページの作成

#### 4.2 特殊日・祝日対応（2-3日）
- 日本の祝日カレンダー実装
- 特殊ダイヤの表示機能
- 運航カレンダーページの作成

#### 4.3 オフライン対応（2-3日）
- ローカルストレージによるキャッシュ
- IndexedDB によるデータ永続化
- オフライン状態の UI 対応

#### 4.4 追加機能（3-4日）
- お気に入りルート機能
- 検索履歴機能
- ホーム画面のカスタマイズ

詳細は`MIGRATION_PLAN.md`を参照してください。

## 現在の課題

1. **テストカバレッジ**: 一部のコンポーネントでテストが不足
   - Tailwind CSS のクラスがテスト環境で認識されない
   - `$fetch` のモック不足による Store テストの失敗
2. **パフォーマンス**: 大量データ表示時の最適化が必要
3. **レスポンシブデザイン**: モバイル表示の更なる改善が必要

## 開発時の注意事項

1. **型安全性**: TypeScript の strict mode を維持し、any 型の使用を避ける
2. **テスト**: 新機能追加時は必ずユニットテストを作成する
3. **国際化**: すべてのテキストは i18n 経由で表示する
4. **アクセシビリティ**: WCAG 2.1 AA 準拠を目指す
5. **レスポンシブ**: モバイルファーストで設計する
6. **下タブナビゲーション**: モバイルでは以下の4項目のみを表示
   - 時刻表 (TIMETABLE)
   - 乗換案内 (TRANSIT)
   - 運行状況 (STATUS)
   - 設定 (SETTINGS)

## フェーズ 4 実装詳細

### 実装スケジュール（合計: 約9-13日）

| タスク | 期間 | 優先度 |
|--------|------|--------|
| 料金表示システム | 2-3日 | 高 |
| 特殊日対応 | 2-3日 | 高 |
| オフライン対応 | 2-3日 | 高 |
| お気に入り機能 | 2日 | 中 |
| 検索履歴 | 1-2日 | 中 |

### 新規作成ファイル（フェーズ4）

```
ferry-transit-nuxt/
├── pages/
│   ├── fare.vue          # 料金表ページ ✅
│   └── calendar.vue      # 運航カレンダーページ ✅
├── composables/
│   ├── useFareDisplay.ts ✅
│   ├── useHolidayCalendar.ts ✅
│   └── useOfflineStorage.ts ✅
├── stores/
│   ├── fare.ts ✅
│   ├── offline.ts ✅
│   ├── favorite.ts ✅
│   └── history.ts ✅ (2025年6月23日追加)
├── types/
│   ├── fare.ts ✅
│   ├── holiday.ts ✅
│   ├── favorite.ts ✅
│   └── history.ts ✅ (2025年6月23日追加)
└── data/
    ├── fare-master.json  # 料金マスターデータ ✅
    └── holidays.json     # 祝日データ ✅
```

## フェーズ 5 実装状況（2025年6月23日完了）✅

### 完了済みタスク

1. **お気に入り機能UI** ✅
   - FavoriteButton.vue - お気に入り登録・削除ボタン
   - FavoriteRouteCard.vue - お気に入りルートカード表示
   - FavoritePortCard.vue - お気に入り港カード表示
   - FavoritesList.vue - お気に入り一覧（ドラッグ&ドロップ対応）
   - FavoritesManager.vue - お気に入り管理画面
   - 乗換案内ページへのお気に入りボタン追加

2. **検索履歴UI** ✅
   - HistoryItem.vue - 履歴アイテムコンポーネント
   - HistoryList.vue - 履歴一覧（日付別グループ化）
   - HistoryManager.vue - 履歴管理画面
   - 検索結果の再利用機能

3. **設定画面** ✅
   - LanguageSelector.vue - 言語切り替え機能
   - ThemeSelector.vue - テーマ設定（ライト/ダーク/システム）
   - DataManagement.vue - データ管理（キャッシュクリア、エクスポート等）
   - 設定ページの実装

4. **UI/UX改善** ✅
   - SkeletonLoader.vue - ローディング時のスケルトンUI
   - カスタムエラーページの実装
   - エラーメッセージの国際化
   - ナビゲーションメニューの拡充

### 技術的な実装詳細

- vuedraggableパッケージを使用したドラッグ&ドロップ機能
- お気に入りと履歴の永続化（LocalStorage）
- タブ間同期機能の実装
- レスポンシブデザインの徹底
- アクセシビリティの考慮（WCAG 2.1 AA準拠を目指す）

## 技術的な変更履歴

### 2025年7月4日
- AngularJS版のファイルを`archive/`ディレクトリに移動
- プロジェクト構造を整理し、Nuxt3版を主要開発対象として明確化
- CLAUDE.mdを更新して新しいディレクトリ構造を反映
- 移動したファイル:
  - AngularJS関連: index.html, js/, css/, images/
  - ビルド設定: bower.json, tsconfig.json, tsd.json, package.json等
  - データベース関連: timetable.sqlite, timetable.php, update_timetable.sh等
  - デザインファイル: oki_ferry.afdesign, posterディレクトリ等

### 2025年6月28日
- ナビゲーションコンポーネントのダークモード対応を実装
- `AppNavigation.vue`にダークモードクラスを追加
  - 背景色: `dark:bg-gray-800`、ボーダー: `dark:border-gray-700`
  - ホバー状態: `dark:hover:bg-gray-700`
  - 言語ドロップダウン: `dark:bg-gray-700`、`dark:text-gray-200`
- `AppBottomNavigation.vue`にダークモードクラスを追加
  - 背景色: `dark:bg-gray-800`、ボーダー: `dark:border-gray-700`
  - アクティブアイコン: `dark:text-blue-400`
  - 非アクティブアイコン: `dark:text-gray-400`
- ビルドとテストが正常に完了することを確認

### 2025年6月23日（フェーズ5完了）
- フェーズ5のUI/UX実装を完了
- お気に入り機能のUIコンポーネント実装
- 検索履歴のUIコンポーネント実装
- 設定画面の実装（言語切替、テーマ、データ管理）
- エラーページとスケルトンUIの追加
- Vue SFCのテンプレート構文エラーを修正
- 下タブナビゲーションの仕様確定（時刻表、乗換案内、運行状況、設定の4項目）

### 2025年6月23日
- 検索履歴機能の実装（`stores/history.ts`）
- 最大50件の履歴保持、30日経過した履歴の自動削除機能
- タブ間同期機能の実装
- ユニットテストの作成と全テスト合格を確認
- 乗換案内機能の改善
  - 料金マスターデータを使用した正確な料金計算
  - JSTタイムゾーン対応の修正
  - AngularJS版に準拠したUI実装（配色、レイアウト、アイコン）
- データファイルの配置修正（public/dataディレクトリへ移動）
- フェーズ4の全タスク完了
- **Vue テンプレート構文の修正**
  - `components/favorites/`と`components/history/`配下の複数のVueファイルで余分な`</template>`タグを削除
  - `FavoriteButton.vue`のスコープ付きスタイルをインラインクラスに移行（Tailwind CSS v4対応）
  - `FavoritePortCard.vue`の未使用インポート（`useTimetableStore`）を削除

### 2025年6月22日
- フェーズ 4 の実装を大幅に進捗
- 料金表示システムの完成（料金マスターデータ、表示ロジック、料金表ページ）
- 特殊日対応の完成（祝日データ、判定ロジック、運航カレンダーページ）
- オフライン対応の実装（LocalStorage によるキャッシュ、オフライン検出、フォールバック）
- 各機能のユニットテストを実装

### 2025年6月21日
- レスポンシブデザインの改善完了
- モバイルタッチターゲットを44x44px以上に拡大
- フェーズ4の詳細計画策定（PWAと予約機能を除外）

### 2025年6月20日
- Bootstrap 5 から Tailwind CSS への移行完了（コミット: 9fabbff）
- 当初の計画では Bootstrap 5 を使用予定だったが、より柔軟なスタイリングのため Tailwind CSS を採用
- すべてのコンポーネントで Tailwind CSS のユーティリティクラスを使用
- Bootstrap JavaScript コンポーネントは Vue 3 のネイティブ機能で実装

## フェーズ 4 実装状況（2025年6月23日更新）✅ 完了

### 完了済みタスク

1. **料金表示システム** ✅
   - 料金マスターデータの作成（`public/data/fare-master.json`）
   - 料金表示ロジックの実装（`composables/useFareDisplay.ts`）
   - 料金表ページの作成（`pages/fare.vue`）
   - 国際化対応（日本語・英語）
   - ユニットテストの実装

2. **特殊日対応** ✅
   - 祝日データの作成（`public/data/holidays.json`）
   - 祝日判定ロジックの実装（`composables/useHolidayCalendar.ts`）
   - 運航カレンダーページの作成（`pages/calendar.vue`）
   - 繁忙期・特別運航情報の表示
   - ユニットテストの実装

3. **オフライン対応** ✅
   - ストレージ管理の実装（`composables/useOfflineStorage.ts`）
   - オフラインストアの作成（`stores/offline.ts`）
   - LocalStorage を使用したデータキャッシュ
   - TTL（有効期限）管理
   - オフライン検出とフォールバック
   - ユニットテストの実装

4. **お気に入り機能** ✅（2025年6月22日完了）
   - お気に入りルートの保存・管理（`stores/favorite.ts`）
   - お気に入り港の保存・管理（最大5港）
   - 並び替え機能（ドラッグ&ドロップ対応）
   - LocalStorageによる永続化
   - タブ間の同期機能
   - ユニットテストの実装

5. **検索履歴機能** ✅（2025年6月23日完了）
   - 検索履歴の自動保存（`stores/history.ts`）
   - 履歴からの再検索機能
   - 最大50件の履歴を保持
   - 30日経過した古い履歴を自動削除
   - タブ間の同期機能
   - ユニットテストの実装
   - 型定義の作成（`types/history.ts`）

### 追加改善項目（2025年6月23日）✅

6. **乗換案内機能の改善**
   - 料金マスターデータを使用した正確な料金計算
   - 繁忙期料金の自動適用
   - JSTタイムゾーンの修正
   - AngularJS版に準拠したUI実装
     - 経路パネルの配色（border-blue-600）
     - 港の行の背景色（#D8ECF3）
     - 船舶の左ボーダー（double 10px）
     - 船舶ごとの色分け（赤、黄、青、ティール）

## フェーズ 4 完了サマリー 🎉

フェーズ 4 のすべてのタスクが正常に完了しました。これにより、FerryTransitのNuxt3版は以下の機能を完全にサポートします：

- **料金計算**: マスターデータに基づく正確な料金表示と繁忙期料金対応
- **祝日・特殊日**: 日本の祝日カレンダーと特別運航情報の表示
- **オフライン対応**: ローカルストレージによるデータキャッシュと自動フォールバック
- **ユーザー体験**: お気に入りルート、検索履歴、UIの統一性
- **国際化**: 日本語・英語の完全対応

## フェーズ 5 実装状況（2025年6月23日完了）✅

フェーズ5（UI/UX完成フェーズ）のすべてのタスクが正常に完了しました。

### 5.1 お気に入り機能UI（2-3日） 🎯

#### 実装ファイル
```
ferry-transit-nuxt/
├── components/
│   ├── favorites/
│   │   ├── FavoriteButton.vue      # お気に入り登録・削除ボタン
│   │   ├── FavoriteRouteCard.vue   # お気に入りルートカード
│   │   ├── FavoritePortCard.vue    # お気に入り港カード
│   │   ├── FavoritesList.vue       # お気に入り一覧表示
│   │   └── FavoritesManager.vue    # お気に入り管理画面
│   └── ui/
│       └── DragDropList.vue        # ドラッグ&ドロップ並び替え
└── pages/
    └── favorites.vue               # お気に入りページ
```

#### 機能詳細
- **お気に入りルートカード**: 出発地・到着地・時刻・料金を表示
- **お気に入り港カード**: 港名・アイコン・次の出発時刻を表示
- **ドラッグ&ドロップ**: タッチデバイス対応の並び替え機能
- **素早いアクセス**: ホーム画面にお気に入りの最新3件を表示
- **検索連携**: お気に入りから直接検索フォームに値を設定

#### UI仕様
- **デザイン**: AngularJS版の配色・レイアウトに準拠
- **レスポンシブ**: モバイル・タブレット・デスクトップ対応
- **アニメーション**: 登録・削除時のフェードイン/アウト
- **アイコン**: 港ごとの専用アイコン表示

### 5.2 検索履歴UI（1-2日） 🎯

#### 実装ファイル
```
ferry-transit-nuxt/
├── components/
│   ├── history/
│   │   ├── HistoryItem.vue         # 履歴アイテム
│   │   ├── HistoryList.vue         # 履歴一覧
│   │   └── HistoryManager.vue      # 履歴管理機能
│   └── search/
│       └── SearchSuggestions.vue   # 検索サジェスト
└── pages/
    └── history.vue                 # 履歴ページ
```

#### 機能詳細
- **履歴表示**: 検索日時・経路・結果サマリーを表示
- **再検索**: ワンクリックで同じ条件で再検索
- **履歴削除**: 個別削除・一括削除機能
- **検索サジェスト**: 入力時に過去の検索履歴を提案
- **フィルタリング**: 日付・港別でのフィルタ機能

#### UI仕様
- **時系列表示**: 最新の検索を上部に表示
- **グループ化**: 同日の検索をグループ化
- **スワイプ削除**: モバイルでのスワイプ削除機能
- **検索統計**: よく検索される経路の表示

### 5.3 設定画面の実装（1-2日）

#### 実装ファイル
```
ferry-transit-nuxt/
├── components/
│   ├── settings/
│   │   ├── LanguageSelector.vue    # 言語設定
│   │   ├── ThemeSelector.vue       # テーマ設定
│   │   ├── NotificationSettings.vue # 通知設定
│   │   └── DataManagement.vue      # データ管理
│   └── ui/
│       └── ToggleSwitch.vue        # スイッチコンポーネント
└── pages/
    └── settings.vue                # 設定ページ
```

#### 機能詳細
- **言語設定**: 日本語・英語の切り替え
- **テーマ設定**: ライト・ダーク・システム連動
- **通知設定**: 運航情報・お気に入り便の通知
- **データ管理**: キャッシュクリア・お気に入りエクスポート
- **アクセシビリティ**: フォントサイズ・コントラスト設定

### 5.4 UI/UX改善（1-2日）

#### 実装項目
- **ローディング状態**: スケルトンUI・プログレスバー
- **エラーハンドリング**: 親しみやすいエラーメッセージ
- **マイクロインタラクション**: ボタンのホバー・タップ効果
- **ページ遷移**: スムーズなトランジション
- **キーボードナビゲーション**: アクセシビリティ向上

### 技術要件

#### パフォーマンス
- **遅延読み込み**: 必要時のみコンポーネント読み込み
- **仮想スクロール**: 大量データの効率的表示
- **キャッシュ最適化**: 画像・データの適切なキャッシュ

#### アクセシビリティ
- **WCAG 2.1 AA準拠**: スクリーンリーダー対応
- **キーボード操作**: 全機能のキーボードアクセス
- **色覚対応**: 色だけに依存しない情報伝達

#### テスト戦略
- **コンポーネントテスト**: Vue Test Utils + Vitest
- **E2Eテスト**: Playwright での操作確認
- **ビジュアルテスト**: スクリーンショット比較
- **アクセシビリティテスト**: axe-core での自動検証

### 実装完了後の成果物

フェーズ5完了により、以下が実現されます：

1. **完全なユーザー体験**: お気に入り・履歴機能の完全な実装
2. **カスタマイズ性**: ユーザー個別のニーズに対応
3. **アクセシビリティ**: 幅広いユーザーが利用可能
4. **パフォーマンス**: 高速でスムーズな操作感
5. **保守性**: テストが充実した高品質なコードベース

これでNuxt3版の核となるUI/UX実装が完成し、管理画面機能の実装準備が整います。

## フェーズ 5.5 管理画面実装（新規追加）

### 実装スケジュール（合計: 約8-10日）

| タスク | 期間 | 優先度 |
|--------|------|--------|
| 管理者認証・権限管理システム | 2日 | 高 |
| 管理画面のダッシュボード実装 | 2日 | 高 |
| フェリーデータ管理機能 | 2-3日 | 高 |
| ユーザー管理機能 | 1-2日 | 中 |
| お知らせ・アラート管理システム | 1-2日 | 中 |
| データエクスポート・インポート機能 | 1日 | 中 |
| 管理画面用UIコンポーネント | 1日 | 中 |
| 管理画面機能のユニットテスト実装 | 1-2日 | 低 |

### 機能要件

#### 5.5.1 管理者認証・権限管理
- **ログイン機能**: 管理者専用のログイン画面
- **権限管理**: 管理者レベル（スーパー管理者、一般管理者）
- **セッション管理**: 自動ログアウト、セッション期限管理
- **セキュリティ**: パスワード暗号化、ログイン試行制限

#### 5.5.2 管理画面ダッシュボード
- **統計情報**: 
  - 日次・月次アクセス数
  - 人気の航路ランキング
  - お気に入り登録数統計
  - 検索履歴分析
- **リアルタイム情報**:
  - 現在のアクティブユーザー数
  - システム稼働状況
  - 最新のエラーログ

#### 5.5.3 フェリーデータ管理
- **時刻表管理**: 
  - 時刻表の追加・編集・削除
  - 運航スケジュールの一括更新
  - 特別ダイヤの設定
- **料金管理**:
  - 料金表の編集
  - 繁忙期料金の設定
  - 割引料金の管理
- **運航状況管理**:
  - 運航アラートの作成・編集
  - 運休情報の管理
  - 遅延情報の更新

#### 5.5.4 ユーザー管理機能
- **アクセス解析**:
  - ユーザーの利用パターン分析
  - 地域別アクセス統計
  - デバイス別利用状況
- **お気に入り統計**:
  - 人気の航路分析
  - お気に入り登録傾向
  - 利用頻度の高い港統計

#### 5.5.5 お知らせ・アラート管理
- **お知らせ管理**:
  - お知らせの作成・編集・削除
  - 公開期間の設定
  - 重要度の設定
- **アラート管理**:
  - 運航アラートの管理
  - 緊急告知の配信
  - 多言語対応のメッセージ管理

#### 5.5.6 データ管理機能
- **エクスポート機能**:
  - 時刻表データのCSV出力
  - 利用統計のExcel出力
  - ユーザーデータのバックアップ
- **インポート機能**:
  - 時刻表データの一括インポート
  - 料金データの更新
  - 祝日データの更新

### 新規作成ファイル（フェーズ5.5）

```
ferry-transit-nuxt/
├── pages/
│   └── admin/
│       ├── index.vue              # 管理画面ダッシュボード
│       ├── login.vue              # 管理者ログイン
│       ├── timetable.vue          # 時刻表管理
│       ├── fare.vue               # 料金管理
│       ├── alerts.vue             # アラート管理
│       ├── announcements.vue      # お知らせ管理
│       ├── users.vue              # ユーザー管理
│       └── data-management.vue    # データ管理
├── components/
│   └── admin/
│       ├── AdminLayout.vue        # 管理画面レイアウト
│       ├── AdminSidebar.vue       # サイドバーナビゲーション
│       ├── AdminHeader.vue        # ヘッダー
│       ├── DashboardCard.vue      # ダッシュボードカード
│       ├── DataTable.vue          # データテーブル
│       ├── FormModal.vue          # フォームモーダル
│       ├── StatisticsChart.vue    # 統計グラフ
│       └── AdminFormComponents.vue # フォーム部品
├── stores/
│   ├── admin.ts                   # 管理機能ストア
│   ├── auth.ts                    # 認証ストア
│   └── analytics.ts               # 分析データストア
├── composables/
│   ├── useAdminAuth.ts           # 管理者認証
│   ├── useAnalytics.ts           # 分析機能
│   └── useDataManagement.ts      # データ管理
├── types/
│   ├── admin.ts                   # 管理機能の型定義
│   ├── auth.ts                    # 認証の型定義
│   └── analytics.ts               # 分析データの型定義
├── middleware/
│   └── admin.ts                   # 管理者権限チェック
└── server/
    └── api/
        └── admin/
            ├── auth.ts            # 認証API
            ├── analytics.ts       # 分析API
            ├── timetable.ts       # 時刻表管理API
            ├── fare.ts            # 料金管理API
            └── announcements.ts   # お知らせ管理API
```

### 技術仕様

#### 認証・セキュリティ
- **JWT認証**: アクセストークンとリフレッシュトークンの管理
- **役割ベースアクセス制御**: 管理者レベルに応じた機能制限
- **CSRF対策**: トークンベースのCSRF保護
- **XSS対策**: サニタイゼーション処理

#### データベース設計
- **管理者テーブル**: 管理者情報、権限レベル
- **ログテーブル**: アクセスログ、操作ログ
- **お知らせテーブル**: お知らせ情報、公開期間
- **アラートテーブル**: 運航アラート、緊急告知

#### API設計
- **RESTful API**: 標準的なREST APIの実装
- **GraphQL対応**: 複雑なクエリに対応
- **レート制限**: API呼び出し制限の実装
- **ログ記録**: すべてのAPI呼び出しをログ記録

### UI/UX設計

#### 管理画面のデザイン
- **レスポンシブデザイン**: デスクトップ・タブレット対応
- **ダークモード対応**: 管理者の作業環境に配慮
- **アクセシビリティ**: キーボードナビゲーション完全対応
- **一貫性**: ユーザー向け画面との統一感

#### コンポーネント設計
- **再利用可能**: 共通コンポーネントの活用
- **カスタマイズ性**: 管理者のニーズに合わせた設定
- **パフォーマンス**: 大量データの効率的な表示
- **エラーハンドリング**: 適切なエラーメッセージ表示

これにより、フェーズ5.5完了後は完全な管理機能を備えたシステムとなり、フェーズ6（Capacitor統合・ネイティブアプリ化）への準備が整います。
